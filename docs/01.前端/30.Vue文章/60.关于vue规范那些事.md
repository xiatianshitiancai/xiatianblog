---
title: 关于vue规范那些事
date: 2021-01-13 14:26:49
permalink: /pages/cc9a6e/
categories: 
  - 前端
  - Vue文章
tags: 
---
# 关于vue规范那些事

大多数人在写代码时不在乎过程前的预定,写完一个功能后，发现突然改需求了，导致代码不够语义化, 造成大量的更改与重写。
<!-- more -->
## 1.什么是代码规范？
> 代码规范是指一些约定俗成的通用格式，比如restful, 形成url不带动词的约定,达到一种平衡,本文不是在讲一个大而全的代码规范，而是针对vue项目来讲一下vuejs的代码规范与注意点。
## 2. 为什么需要代码规范or风格指南？
> 代码规范的定义是面向未来的，我们在引用一些库or框架时,要考虑框架维护者如果升级框架会给本项目造成的影响，有些 Vue 特性的存在是为了照顾极端情况或帮助老代码的平稳迁移。当被过度使用时，这些特性会让你的代码难于维护甚至变成 bug 的来源。这些规则是为了给有潜在风险的特性敲个警钟，并说明它们什么时候不应该使用以及为什么。
## 3.vuejs的代码规范or风格指南？
> 在**vue**中将风格列为以下四类 
 - 优先级 A：必要的
 - 优先级 B：强烈推荐
 - 优先级 C：推荐
 - 优先级 D：谨慎使用

### 代码规范
#### 1. 组件名为多个单词
> 这样做可以避免跟现有的以及未来的 HTML 元素相冲突，因为所有的 HTML 元素名称都是单个单词的。
正例
```js
Vue.component('todo-item', {
  // ...
})

```
反例
```js
Vue.component('todo', {
  // ...
})
```
### 2. 组件数据必须使用函数来定义
> 在组件系统中，如果使用data对象来定义,如果在复用时会导致一个组件更改了数据，另外一个组件的数据也被更改了，所以必须使用函数
正例
```js
Vue.component('some-comp', {
  data: function () {
    return {
      foo: 'bar'
    }
  }
})

```
反例
```js
Vue.component('some-comp', {
    data:{
    }
})
```

### 3. props 尽量定义明确的数据
> 当我们使用props传递参数时，尽量使用明确的数据类型,如数组,函数, 字符串, 数字等。 这个就像ts一样, 在做数据检查时就可以避免一些不必要的异常。


反例
```js
props: ['status']
```

正例
```js
props: {
  status: {
    type: String,
    required: true,
    validator: function (value) {
      return [
        'syncing',
        'synced',
        'version-conflict',
        'error'
      ].indexOf(value) !== -1
    }
  }
}
```

### 4. 为 v-for 设置键值
> 这里不需要做过多的解释, 在固定的对象中vue底层可能不需要去更新子树的dom来达到目的, 另外key的值也尽量使用对象中的id 而不是index，因为index在子树中可能并不唯一。

### 5. 为组件样式设置作用域
> 这条规则只和单文件组件有关。你不一定要使用 scoped attribute。设置作用域也可以通过 CSS Modules，那是一个基于 class 的类似 BEM 的策略，当然你也可以使用其它的库或约定。另外这里的样式模块化业界常用三种方式，一种是采用scope 的方式，第二种是css module, 第三种为[BEM](https://bemcss.com/),BEM是通过css的类名控制代码的样式，达到避免样式冲突的目的。

**好例子**
```html
<template>
  <button class="button button-close">X</button>
</template>

<!-- 使用 `scoped` attribute -->
<style scoped>
.button {
  border: none;
  border-radius: 2px;
}

.button-close {
  background-color: red;
}
</style>
```
**好例子**
```html
<template>
  <button :class="[$style.button, $style.buttonClose]">X</button>
</template>

<!-- 使用 CSS Modules -->
<style module>
.button {
  border: none;
  border-radius: 2px;
}

.buttonClose {
  background-color: red;
}
</style>
```
**好例子**
```html
<template>
  <button class="c-Button c-Button--close">X</button>
</template>

<!-- 使用 BEM 约定 -->
<style>
.c-Button {
  border: none;
  border-radius: 2px;
}

.c-Button--close {
  background-color: red;
}
</style>
```

### 6.私有函数的命名问题
> 通常这种情况是为了避免内部函数被外部调用,而下次升级导致的一些牵一发而动全身的事件，例如我在组件中抛出了一些可提供给外部的方法, 另外一些方法是我在处理这些组件逻辑时使用的私有方法,此时表示这个私有方法可能会被组件维护者重构，而你使用他之后导致组件维护者可能不知道此方法该不该删除，导致一些不必要的异常.
好例子
```js
// 正常的好例子
var myGreatMixin = {
  // ...
  methods: {
    $_myGreatMixin_update: function () {
      // ...
    }
  }
}
// 更好的例子 私有方法不对外暴露是最好的方式
var myGreatMixin = {
  // ...
  methods: {
    publicMethod() {
      // ...
      myPrivateFunction()
    }
  }
}

function myPrivateFunction() {
  // ...
}

export default myGreatMixin
```

### 7. 组件文件的命名
> 在使用vue-cli时常常会为各种大写小写的组件命名而头疼, 开发者往往会定义各种诸如 Search.vue  mycomponent.vue 这种命名，既不通用，也不好记住.
> **记住2点** 
> 1.只要有能够拼接文件的构建系统，就把每个组件单独分成文件。
> 2. 单文件组件的文件名应该要么始终是单词大写开头 (PascalCase)，要么始终是横线连接 (kebab-case)。

正例
```
components/
|- TodoList.js
|- TodoItem.js
components/
|- TodoList.vue
|- TodoItem.vue
components/
|- MyComponent.vue
components/
|- my-component.vue
```
反例
``` js
组件通过单文件拆分，拆分成文件不应该
Vue.component('TodoList', {
  // ...
})
Vue.component('TodoItem', {
  // ...
})
// 组件的命名应该保持首字母大些or 用-连接
components/
|- mycomponent.vue
components/
|- myComponent.vue
```

### 8. 基础组件命名
> 基础展示类的组件应该命名为有特殊变量的组件命名而不是类似于my-button icon 等

**正例**
```
components/
|- BaseButton.vue
|- BaseTable.vue
|- BaseIcon.vue
components/
|- AppButton.vue
|- AppTable.vue
|- AppIcon.vue
components/
|- VButton.vue
|- VTable.vue
|- VIcon.vue
```
**反例**
```
components/
|- MyButton.vue
|- VueTable.vue
|- Icon.vue
```

### 9.单例文件组件前面加the表明其唯一性
> 只应该拥有单个活跃实例的组件应该以 The 前缀命名，以示其唯一性。如何判断这个组件是否具备复用性的原则是需不需要加入props。

**正例**
```
components/
|- TheHeading.vue
|- TheSidebar.vue

```
**反例**
```
components/
|- Heading.vue
|- MySidebar.vue
```

### 10. 紧密耦合的组件名
> 紧密耦合的组件名应该子组件在父组件的基础上添加新的单词来标示其组件。原因是因为编辑器会将字符相近的文件排列在一起，让我们使用组件时更容易找到一类文件。

**正例**
```
components/
|- TodoList.vue
|- TodoListItem.vue
|- TodoListItemButton.vue
```

**反例**
```
components/
|- TodoList.vue
|- TodoItem.vue
|- TodoButton.vue
```